"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/enviar-mensagem";
exports.ids = ["pages/api/enviar-mensagem"];
exports.modules = {

/***/ "fs-extra":
/*!***************************!*\
  !*** external "fs-extra" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("fs-extra");

/***/ }),

/***/ "multer":
/*!*************************!*\
  !*** external "multer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("multer");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "qrcode-terminal":
/*!**********************************!*\
  !*** external "qrcode-terminal" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("qrcode-terminal");

/***/ }),

/***/ "whatsapp-web.js":
/*!**********************************!*\
  !*** external "whatsapp-web.js" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("whatsapp-web.js");

/***/ }),

/***/ "libphonenumber-js":
/*!************************************!*\
  !*** external "libphonenumber-js" ***!
  \************************************/
/***/ ((module) => {

module.exports = import("libphonenumber-js");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenviar-mensagem&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cenviar-mensagem.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenviar-mensagem&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cenviar-mensagem.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\enviar-mensagem.ts */ \"(api)/./pages/api/enviar-mensagem.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/enviar-mensagem\",\n        pathname: \"/api/enviar-mensagem\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_enviar_mensagem_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmVudmlhci1tZW5zYWdlbSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDZW52aWFyLW1lbnNhZ2VtLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzZEO0FBQzdEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywwREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaW50ZWxpZ2VuY2lhYXJ0aWZpY2lhbGdydXBvbGV0aGFuLz85ZjRkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcZW52aWFyLW1lbnNhZ2VtLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZW52aWFyLW1lbnNhZ2VtXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZW52aWFyLW1lbnNhZ2VtXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenviar-mensagem&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cenviar-mensagem.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/enviar-mensagem.ts":
/*!**************************************!*\
  !*** ./pages/api/enviar-mensagem.ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! multer */ \"multer\");\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(multer__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var libphonenumber_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! libphonenumber-js */ \"libphonenumber-js\");\n/* harmony import */ var whatsapp_web_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! whatsapp-web.js */ \"whatsapp-web.js\");\n/* harmony import */ var whatsapp_web_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(whatsapp_web_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _utils_whatsappClient__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/whatsappClient */ \"(api)/./utils/whatsappClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([libphonenumber_js__WEBPACK_IMPORTED_MODULE_1__]);\nlibphonenumber_js__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n// Configuração do multer\nconst upload = multer__WEBPACK_IMPORTED_MODULE_0___default()({\n    dest: \"/tmp\"\n});\n// Função para gerar um atraso aleatório entre 5 e 10 minutos (em milissegundos)\nconst atrasoAleatorio = ()=>{\n    return Math.floor(Math.random() * (600000 - 300000 + 1) + 300000); // 300000ms = 5min, 600000ms = 10min\n};\n// Função de espera bloqueante\nconst esperaBloqueante = (ms)=>{\n    const inicio = Date.now();\n    while(Date.now() - inicio < ms){\n    // Espera ativamente\n    }\n};\nasync function enviarMensagemComAtraso(cliente, mensagem, media) {\n    try {\n        const phoneNumber = (0,libphonenumber_js__WEBPACK_IMPORTED_MODULE_1__.parsePhoneNumber)(cliente.numero, \"BR\");\n        if (!phoneNumber || !phoneNumber.isValid()) {\n            throw new Error(`Número de telefone inválido: ${cliente.numero}`);\n        }\n        const formattedNumber = phoneNumber.format(\"E.164\").slice(1);\n        const mensagemFinal = mensagem.replace(\"{link}\", cliente.link);\n        if (media) {\n            await _utils_whatsappClient__WEBPACK_IMPORTED_MODULE_5__[\"default\"].sendMessage(`${formattedNumber}@c.us`, media, {\n                caption: mensagemFinal\n            });\n        } else {\n            await _utils_whatsappClient__WEBPACK_IMPORTED_MODULE_5__[\"default\"].sendMessage(`${formattedNumber}@c.us`, mensagemFinal);\n        }\n        console.log(`Mensagem enviada para ${cliente.nome} (${formattedNumber}) em ${new Date().toISOString()}`);\n        const atraso = atrasoAleatorio();\n        console.log(`Aguardando ${atraso / 60000} minutos antes do próximo envio. Hora atual: ${new Date().toISOString()}`);\n        esperaBloqueante(atraso);\n        console.log(`Espera concluída. Hora atual: ${new Date().toISOString()}`);\n    } catch (error) {\n        console.error(`Erro ao enviar mensagem para ${cliente.nome}:`, error);\n    }\n}\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method === \"POST\") {\n        const multerMiddleware = upload.single(\"imagem\");\n        multerMiddleware(req, res, async (err)=>{\n            if (err) {\n                return res.status(500).json({\n                    error: \"Erro ao processar o upload do arquivo\"\n                });\n            }\n            try {\n                await _utils_whatsappClient__WEBPACK_IMPORTED_MODULE_5__[\"default\"].waitForReady();\n            } catch (error) {\n                console.error(\"Erro ao esperar pelo cliente WhatsApp:\", error);\n                return res.status(500).json({\n                    error: \"Cliente WhatsApp n\\xe3o est\\xe1 pronto\"\n                });\n            }\n            const { clientesSelecionados, mensagem } = req.body;\n            console.log(\"Dados recebidos:\");\n            console.log(\"Clientes selecionados:\", clientesSelecionados);\n            console.log(\"Mensagem:\", mensagem);\n            console.log(\"Arquivo:\", req.file);\n            if (!clientesSelecionados || !mensagem) {\n                return res.status(400).json({\n                    error: \"Faltam dados para o envio da mensagem\"\n                });\n            }\n            const clientes = JSON.parse(clientesSelecionados);\n            let media;\n            if (req.file) {\n                const fileData = fs__WEBPACK_IMPORTED_MODULE_3___default().readFileSync(req.file.path);\n                const base64Data = fileData.toString(\"base64\");\n                media = new whatsapp_web_js__WEBPACK_IMPORTED_MODULE_2__.MessageMedia(\"image/png\", base64Data, path__WEBPACK_IMPORTED_MODULE_4___default().basename(req.file.originalname));\n            }\n            // Envia a resposta imediatamente\n            res.status(200).json({\n                message: \"Mensagens enfileiradas para envio\"\n            });\n            // Processa as mensagens em segundo plano\n            (async ()=>{\n                for (const cliente of clientes){\n                    await enviarMensagemComAtraso(cliente, mensagem, media);\n                }\n                // Remover o arquivo temporário após o envio\n                if (req.file) {\n                    fs__WEBPACK_IMPORTED_MODULE_3___default().unlinkSync(req.file.path);\n                }\n                console.log(\"Todas as mensagens foram enviadas.\");\n            })().catch((error)=>{\n                console.error(\"Erro ao enviar mensagens:\", error);\n            });\n        });\n    } else {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZW52aWFyLW1lbnNhZ2VtLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUM0QjtBQUN5QjtBQUNOO0FBQzNCO0FBQ0k7QUFDZ0M7QUFPeEQseUJBQXlCO0FBQ3pCLE1BQU1NLFNBQVNOLDZDQUFNQSxDQUFDO0lBQUVPLE1BQU07QUFBTztBQUVyQyxnRkFBZ0Y7QUFDaEYsTUFBTUMsa0JBQWtCO0lBQ3BCLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFNLFVBQVMsU0FBUyxLQUFLLFNBQVMsb0NBQW9DO0FBQzNHO0FBRUEsOEJBQThCO0FBQzlCLE1BQU1DLG1CQUFtQixDQUFDQztJQUN0QixNQUFNQyxTQUFTQyxLQUFLQyxHQUFHO0lBQ3ZCLE1BQU9ELEtBQUtDLEdBQUcsS0FBS0YsU0FBU0QsR0FBSTtJQUM3QixvQkFBb0I7SUFDeEI7QUFDSjtBQUVBLGVBQWVJLHdCQUF3QkMsT0FBWSxFQUFFQyxRQUFnQixFQUFFQyxLQUFvQjtJQUN2RixJQUFJO1FBQ0EsTUFBTUMsY0FBY3BCLG1FQUFnQkEsQ0FBQ2lCLFFBQVFJLE1BQU0sRUFBRTtRQUNyRCxJQUFJLENBQUNELGVBQWUsQ0FBQ0EsWUFBWUUsT0FBTyxJQUFJO1lBQ3hDLE1BQU0sSUFBSUMsTUFBTSxDQUFDLDZCQUE2QixFQUFFTixRQUFRSSxNQUFNLENBQUMsQ0FBQztRQUNwRTtRQUNBLE1BQU1HLGtCQUFrQkosWUFBWUssTUFBTSxDQUFDLFNBQVNDLEtBQUssQ0FBQztRQUUxRCxNQUFNQyxnQkFBZ0JULFNBQVNVLE9BQU8sQ0FBQyxVQUFVWCxRQUFRWSxJQUFJO1FBRTdELElBQUlWLE9BQU87WUFDUCxNQUFNZiw2REFBY0EsQ0FBQzBCLFdBQVcsQ0FBQyxDQUFDLEVBQUVOLGdCQUFnQixLQUFLLENBQUMsRUFBRUwsT0FBTztnQkFBRVksU0FBU0o7WUFBYztRQUNoRyxPQUFPO1lBQ0gsTUFBTXZCLDZEQUFjQSxDQUFDMEIsV0FBVyxDQUFDLENBQUMsRUFBRU4sZ0JBQWdCLEtBQUssQ0FBQyxFQUFFRztRQUNoRTtRQUVBSyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxzQkFBc0IsRUFBRWhCLFFBQVFpQixJQUFJLENBQUMsRUFBRSxFQUFFVixnQkFBZ0IsS0FBSyxFQUFFLElBQUlWLE9BQU9xQixXQUFXLEdBQUcsQ0FBQztRQUV2RyxNQUFNQyxTQUFTN0I7UUFDZnlCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRUcsU0FBUyxNQUFNLDZDQUE2QyxFQUFFLElBQUl0QixPQUFPcUIsV0FBVyxHQUFHLENBQUM7UUFDbEh4QixpQkFBaUJ5QjtRQUNqQkosUUFBUUMsR0FBRyxDQUFDLENBQUMsOEJBQThCLEVBQUUsSUFBSW5CLE9BQU9xQixXQUFXLEdBQUcsQ0FBQztJQUMzRSxFQUFFLE9BQU9FLE9BQU87UUFDWkwsUUFBUUssS0FBSyxDQUFDLENBQUMsNkJBQTZCLEVBQUVwQixRQUFRaUIsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFRztJQUNuRTtBQUNKO0FBRU8sTUFBTUMsU0FBUztJQUNsQkMsS0FBSztRQUNEQyxZQUFZO0lBQ2hCO0FBQ0osRUFBRTtBQUVhLGVBQWVDLFFBQVFDLEdBQTJCLEVBQUVDLEdBQW9CO0lBQ25GLElBQUlELElBQUlFLE1BQU0sS0FBSyxRQUFRO1FBQ3ZCLE1BQU1DLG1CQUFtQnhDLE9BQU95QyxNQUFNLENBQUM7UUFFdkNELGlCQUFpQkgsS0FBWUMsS0FBWSxPQUFPSTtZQUM1QyxJQUFJQSxLQUFLO2dCQUNMLE9BQU9KLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQUVaLE9BQU87Z0JBQXdDO1lBQ2pGO1lBRUEsSUFBSTtnQkFDQSxNQUFNakMsNkRBQWNBLENBQUM4QyxZQUFZO1lBQ3JDLEVBQUUsT0FBT2IsT0FBTztnQkFDWkwsUUFBUUssS0FBSyxDQUFDLDBDQUEwQ0E7Z0JBQ3hELE9BQU9NLElBQUlLLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQUVaLE9BQU87Z0JBQW1DO1lBQzVFO1lBRUEsTUFBTSxFQUFFYyxvQkFBb0IsRUFBRWpDLFFBQVEsRUFBRSxHQUFHd0IsSUFBSVUsSUFBSTtZQUVuRHBCLFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMsMEJBQTBCa0I7WUFDdENuQixRQUFRQyxHQUFHLENBQUMsYUFBYWY7WUFDekJjLFFBQVFDLEdBQUcsQ0FBQyxZQUFZUyxJQUFJVyxJQUFJO1lBRWhDLElBQUksQ0FBQ0Ysd0JBQXdCLENBQUNqQyxVQUFVO2dCQUNwQyxPQUFPeUIsSUFBSUssTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRVosT0FBTztnQkFBd0M7WUFDakY7WUFFQSxNQUFNaUIsV0FBV0MsS0FBS0MsS0FBSyxDQUFDTDtZQUU1QixJQUFJaEM7WUFDSixJQUFJdUIsSUFBSVcsSUFBSSxFQUFFO2dCQUNWLE1BQU1JLFdBQVd2RCxzREFBZSxDQUFDd0MsSUFBSVcsSUFBSSxDQUFDbEQsSUFBSTtnQkFDOUMsTUFBTXdELGFBQWFGLFNBQVNHLFFBQVEsQ0FBQztnQkFDckN6QyxRQUFRLElBQUlsQix5REFBWUEsQ0FBQyxhQUFhMEQsWUFBWXhELG9EQUFhLENBQUN1QyxJQUFJVyxJQUFJLENBQUNTLFlBQVk7WUFDekY7WUFFQSxpQ0FBaUM7WUFDakNuQixJQUFJSyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFYyxTQUFTO1lBQW9DO1lBRXBFLHlDQUF5QztZQUN4QztnQkFDRyxLQUFLLE1BQU05QyxXQUFXcUMsU0FBVTtvQkFDNUIsTUFBTXRDLHdCQUF3QkMsU0FBU0MsVUFBVUM7Z0JBQ3JEO2dCQUVBLDRDQUE0QztnQkFDNUMsSUFBSXVCLElBQUlXLElBQUksRUFBRTtvQkFDVm5ELG9EQUFhLENBQUN3QyxJQUFJVyxJQUFJLENBQUNsRCxJQUFJO2dCQUMvQjtnQkFFQTZCLFFBQVFDLEdBQUcsQ0FBQztZQUNoQixLQUFLZ0MsS0FBSyxDQUFDNUIsQ0FBQUE7Z0JBQ1BMLFFBQVFLLEtBQUssQ0FBQyw2QkFBNkJBO1lBQy9DO1FBQ0o7SUFDSixPQUFPO1FBQ0hNLElBQUl1QixTQUFTLENBQUMsU0FBUztZQUFDO1NBQU87UUFDL0J2QixJQUFJSyxNQUFNLENBQUMsS0FBS21CLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRXpCLElBQUlFLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDMUQ7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL2ludGVsaWdlbmNpYWFydGlmaWNpYWxncnVwb2xldGhhbi8uL3BhZ2VzL2FwaS9lbnZpYXItbWVuc2FnZW0udHM/MmQwZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCBtdWx0ZXIgZnJvbSAnbXVsdGVyJztcclxuaW1wb3J0IHsgcGFyc2VQaG9uZU51bWJlciB9IGZyb20gJ2xpYnBob25lbnVtYmVyLWpzJztcclxuaW1wb3J0IHsgTWVzc2FnZU1lZGlhIH0gZnJvbSAnd2hhdHNhcHAtd2ViLmpzJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCB3aGF0c2FwcENsaWVudCBmcm9tICcuLi8uLi91dGlscy93aGF0c2FwcENsaWVudCc7XHJcblxyXG4vLyBBZGljaW9uZSBlc3RhIGludGVyZmFjZVxyXG5pbnRlcmZhY2UgTmV4dEFwaVJlcXVlc3RXaXRoRmlsZSBleHRlbmRzIE5leHRBcGlSZXF1ZXN0IHtcclxuICAgIGZpbGU/OiBFeHByZXNzLk11bHRlci5GaWxlO1xyXG59XHJcblxyXG4vLyBDb25maWd1cmHDp8OjbyBkbyBtdWx0ZXJcclxuY29uc3QgdXBsb2FkID0gbXVsdGVyKHsgZGVzdDogJy90bXAnIH0pO1xyXG5cclxuLy8gRnVuw6fDo28gcGFyYSBnZXJhciB1bSBhdHJhc28gYWxlYXTDs3JpbyBlbnRyZSA1IGUgMTAgbWludXRvcyAoZW0gbWlsaXNzZWd1bmRvcylcclxuY29uc3QgYXRyYXNvQWxlYXRvcmlvID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICg2MDAwMDAgLSAzMDAwMDAgKyAxKSArIDMwMDAwMCk7IC8vIDMwMDAwMG1zID0gNW1pbiwgNjAwMDAwbXMgPSAxMG1pblxyXG59O1xyXG5cclxuLy8gRnVuw6fDo28gZGUgZXNwZXJhIGJsb3F1ZWFudGVcclxuY29uc3QgZXNwZXJhQmxvcXVlYW50ZSA9IChtczogbnVtYmVyKSA9PiB7XHJcbiAgICBjb25zdCBpbmljaW8gPSBEYXRlLm5vdygpO1xyXG4gICAgd2hpbGUgKERhdGUubm93KCkgLSBpbmljaW8gPCBtcykge1xyXG4gICAgICAgIC8vIEVzcGVyYSBhdGl2YW1lbnRlXHJcbiAgICB9XHJcbn07XHJcblxyXG5hc3luYyBmdW5jdGlvbiBlbnZpYXJNZW5zYWdlbUNvbUF0cmFzbyhjbGllbnRlOiBhbnksIG1lbnNhZ2VtOiBzdHJpbmcsIG1lZGlhPzogTWVzc2FnZU1lZGlhKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHBob25lTnVtYmVyID0gcGFyc2VQaG9uZU51bWJlcihjbGllbnRlLm51bWVybywgJ0JSJyk7XHJcbiAgICAgICAgaWYgKCFwaG9uZU51bWJlciB8fCAhcGhvbmVOdW1iZXIuaXNWYWxpZCgpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTsO6bWVybyBkZSB0ZWxlZm9uZSBpbnbDoWxpZG86ICR7Y2xpZW50ZS5udW1lcm99YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZE51bWJlciA9IHBob25lTnVtYmVyLmZvcm1hdCgnRS4xNjQnKS5zbGljZSgxKTtcclxuXHJcbiAgICAgICAgY29uc3QgbWVuc2FnZW1GaW5hbCA9IG1lbnNhZ2VtLnJlcGxhY2UoJ3tsaW5rfScsIGNsaWVudGUubGluayk7XHJcblxyXG4gICAgICAgIGlmIChtZWRpYSkge1xyXG4gICAgICAgICAgICBhd2FpdCB3aGF0c2FwcENsaWVudC5zZW5kTWVzc2FnZShgJHtmb3JtYXR0ZWROdW1iZXJ9QGMudXNgLCBtZWRpYSwgeyBjYXB0aW9uOiBtZW5zYWdlbUZpbmFsIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHdoYXRzYXBwQ2xpZW50LnNlbmRNZXNzYWdlKGAke2Zvcm1hdHRlZE51bWJlcn1AYy51c2AsIG1lbnNhZ2VtRmluYWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coYE1lbnNhZ2VtIGVudmlhZGEgcGFyYSAke2NsaWVudGUubm9tZX0gKCR7Zm9ybWF0dGVkTnVtYmVyfSkgZW0gJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgYXRyYXNvID0gYXRyYXNvQWxlYXRvcmlvKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEFndWFyZGFuZG8gJHthdHJhc28gLyA2MDAwMH0gbWludXRvcyBhbnRlcyBkbyBwcsOzeGltbyBlbnZpby4gSG9yYSBhdHVhbDogJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9YCk7XHJcbiAgICAgICAgZXNwZXJhQmxvcXVlYW50ZShhdHJhc28pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBFc3BlcmEgY29uY2x1w61kYS4gSG9yYSBhdHVhbDogJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9YCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm8gYW8gZW52aWFyIG1lbnNhZ2VtIHBhcmEgJHtjbGllbnRlLm5vbWV9OmAsIGVycm9yKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICAgIGFwaToge1xyXG4gICAgICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxyXG4gICAgfSxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdFdpdGhGaWxlLCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gICAgaWYgKHJlcS5tZXRob2QgPT09ICdQT1NUJykge1xyXG4gICAgICAgIGNvbnN0IG11bHRlck1pZGRsZXdhcmUgPSB1cGxvYWQuc2luZ2xlKCdpbWFnZW0nKTtcclxuXHJcbiAgICAgICAgbXVsdGVyTWlkZGxld2FyZShyZXEgYXMgYW55LCByZXMgYXMgYW55LCBhc3luYyAoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJybyBhbyBwcm9jZXNzYXIgbyB1cGxvYWQgZG8gYXJxdWl2bycgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB3aGF0c2FwcENsaWVudC53YWl0Rm9yUmVhZHkoKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gZXNwZXJhciBwZWxvIGNsaWVudGUgV2hhdHNBcHA6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdDbGllbnRlIFdoYXRzQXBwIG7Do28gZXN0w6EgcHJvbnRvJyB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgeyBjbGllbnRlc1NlbGVjaW9uYWRvcywgbWVuc2FnZW0gfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhZG9zIHJlY2ViaWRvczonKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NsaWVudGVzIHNlbGVjaW9uYWRvczonLCBjbGllbnRlc1NlbGVjaW9uYWRvcyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNZW5zYWdlbTonLCBtZW5zYWdlbSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBcnF1aXZvOicsIHJlcS5maWxlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghY2xpZW50ZXNTZWxlY2lvbmFkb3MgfHwgIW1lbnNhZ2VtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ZhbHRhbSBkYWRvcyBwYXJhIG8gZW52aW8gZGEgbWVuc2FnZW0nIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjbGllbnRlcyA9IEpTT04ucGFyc2UoY2xpZW50ZXNTZWxlY2lvbmFkb3MpO1xyXG5cclxuICAgICAgICAgICAgbGV0IG1lZGlhOiBNZXNzYWdlTWVkaWEgfCB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmIChyZXEuZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZURhdGEgPSBmcy5yZWFkRmlsZVN5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gZmlsZURhdGEudG9TdHJpbmcoJ2Jhc2U2NCcpO1xyXG4gICAgICAgICAgICAgICAgbWVkaWEgPSBuZXcgTWVzc2FnZU1lZGlhKCdpbWFnZS9wbmcnLCBiYXNlNjREYXRhLCBwYXRoLmJhc2VuYW1lKHJlcS5maWxlLm9yaWdpbmFsbmFtZSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBFbnZpYSBhIHJlc3Bvc3RhIGltZWRpYXRhbWVudGVcclxuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnTWVuc2FnZW5zIGVuZmlsZWlyYWRhcyBwYXJhIGVudmlvJyB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFByb2Nlc3NhIGFzIG1lbnNhZ2VucyBlbSBzZWd1bmRvIHBsYW5vXHJcbiAgICAgICAgICAgIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNsaWVudGUgb2YgY2xpZW50ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBlbnZpYXJNZW5zYWdlbUNvbUF0cmFzbyhjbGllbnRlLCBtZW5zYWdlbSwgbWVkaWEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZXIgbyBhcnF1aXZvIHRlbXBvcsOhcmlvIGFww7NzIG8gZW52aW9cclxuICAgICAgICAgICAgICAgIGlmIChyZXEuZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMocmVxLmZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1RvZGFzIGFzIG1lbnNhZ2VucyBmb3JhbSBlbnZpYWRhcy4nKTtcclxuICAgICAgICAgICAgfSkoKS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGVudmlhciBtZW5zYWdlbnM6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ1BPU1QnXSk7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgKTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsibXVsdGVyIiwicGFyc2VQaG9uZU51bWJlciIsIk1lc3NhZ2VNZWRpYSIsImZzIiwicGF0aCIsIndoYXRzYXBwQ2xpZW50IiwidXBsb2FkIiwiZGVzdCIsImF0cmFzb0FsZWF0b3JpbyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImVzcGVyYUJsb3F1ZWFudGUiLCJtcyIsImluaWNpbyIsIkRhdGUiLCJub3ciLCJlbnZpYXJNZW5zYWdlbUNvbUF0cmFzbyIsImNsaWVudGUiLCJtZW5zYWdlbSIsIm1lZGlhIiwicGhvbmVOdW1iZXIiLCJudW1lcm8iLCJpc1ZhbGlkIiwiRXJyb3IiLCJmb3JtYXR0ZWROdW1iZXIiLCJmb3JtYXQiLCJzbGljZSIsIm1lbnNhZ2VtRmluYWwiLCJyZXBsYWNlIiwibGluayIsInNlbmRNZXNzYWdlIiwiY2FwdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJub21lIiwidG9JU09TdHJpbmciLCJhdHJhc28iLCJlcnJvciIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwibXVsdGVyTWlkZGxld2FyZSIsInNpbmdsZSIsImVyciIsInN0YXR1cyIsImpzb24iLCJ3YWl0Rm9yUmVhZHkiLCJjbGllbnRlc1NlbGVjaW9uYWRvcyIsImJvZHkiLCJmaWxlIiwiY2xpZW50ZXMiLCJKU09OIiwicGFyc2UiLCJmaWxlRGF0YSIsInJlYWRGaWxlU3luYyIsImJhc2U2NERhdGEiLCJ0b1N0cmluZyIsImJhc2VuYW1lIiwib3JpZ2luYWxuYW1lIiwibWVzc2FnZSIsInVubGlua1N5bmMiLCJjYXRjaCIsInNldEhlYWRlciIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/enviar-mensagem.ts\n");

/***/ }),

/***/ "(api)/./utils/whatsappClient.ts":
/*!*********************************!*\
  !*** ./utils/whatsappClient.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var whatsapp_web_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! whatsapp-web.js */ \"whatsapp-web.js\");\n/* harmony import */ var whatsapp_web_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(whatsapp_web_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var qrcode_terminal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! qrcode-terminal */ \"qrcode-terminal\");\n/* harmony import */ var qrcode_terminal__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(qrcode_terminal__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var fs_extra__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs-extra */ \"fs-extra\");\n/* harmony import */ var fs_extra__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs_extra__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass WhatsAppClient {\n    constructor(){\n        this.isReady = false;\n        this.sessionPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \".wwebjs_auth\");\n        this.client = new whatsapp_web_js__WEBPACK_IMPORTED_MODULE_0__.Client({\n            authStrategy: new whatsapp_web_js__WEBPACK_IMPORTED_MODULE_0__.LocalAuth({\n                dataPath: this.sessionPath,\n                clientId: \"client-one\" // Adicione um ID único para o cliente\n            }),\n            puppeteer: {\n                headless: true,\n                args: [\n                    \"--no-sandbox\",\n                    \"--disable-setuid-sandbox\"\n                ]\n            }\n        });\n        this.client.on(\"qr\", (qr)=>{\n            qrcode_terminal__WEBPACK_IMPORTED_MODULE_1___default().generate(qr, {\n                small: true\n            });\n            console.log(\"QR RECEIVED. Scan it with your WhatsApp app.\");\n        });\n        this.client.on(\"ready\", ()=>{\n            console.log(\"WhatsApp client is ready!\");\n            this.isReady = true;\n        });\n        this.client.on(\"disconnected\", async (reason)=>{\n            console.log(\"WhatsApp client was disconnected\", reason);\n            this.isReady = false;\n            await this.cleanSession();\n            this.initialize(); // Tenta reinicializar após desconexão\n        });\n        this.initialize();\n    }\n    static getInstance() {\n        if (!WhatsAppClient.instance) {\n            WhatsAppClient.instance = new WhatsAppClient();\n        }\n        return WhatsAppClient.instance;\n    }\n    async initialize() {\n        try {\n            await this.client.initialize();\n        } catch (error) {\n            console.error(\"Failed to initialize WhatsApp client:\", error);\n            await this.cleanSession();\n            // Tenta inicializar novamente após limpar a sessão\n            setTimeout(()=>this.initialize(), 5000);\n        }\n    }\n    async cleanSession() {\n        try {\n            await fs_extra__WEBPACK_IMPORTED_MODULE_3___default().remove(this.sessionPath);\n            console.log(\"Session cleaned successfully\");\n        } catch (error) {\n            console.error(\"Failed to clean session:\", error);\n        }\n    }\n    async sendMessage(to, content, options) {\n        if (!this.isReady) {\n            throw new Error(\"WhatsApp client is not ready\");\n        }\n        return await this.client.sendMessage(to, content, options);\n    }\n    async waitForReady() {\n        if (this.isReady) return;\n        return new Promise((resolve)=>{\n            const checkReady = setInterval(()=>{\n                if (this.isReady) {\n                    clearInterval(checkReady);\n                    resolve();\n                }\n            }, 1000);\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (WhatsAppClient.getInstance());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy93aGF0c2FwcENsaWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBa0U7QUFDN0I7QUFDYjtBQUNFO0FBRTFCLE1BQU1LO0lBTUosYUFBc0I7YUFIZEMsVUFBbUI7UUFJekIsSUFBSSxDQUFDQyxXQUFXLEdBQUdKLGdEQUFTLENBQUNNLFFBQVFDLEdBQUcsSUFBSTtRQUU1QyxJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJWCxtREFBTUEsQ0FBQztZQUN2QlksY0FBYyxJQUFJWCxzREFBU0EsQ0FBQztnQkFDMUJZLFVBQVUsSUFBSSxDQUFDTixXQUFXO2dCQUMxQk8sVUFBVSxhQUFhLHNDQUFzQztZQUMvRDtZQUNBQyxXQUFXO2dCQUNUQyxVQUFVO2dCQUNWQyxNQUFNO29CQUFDO29CQUFnQjtpQkFBMkI7WUFDcEQ7UUFDRjtRQUVBLElBQUksQ0FBQ04sTUFBTSxDQUFDTyxFQUFFLENBQUMsTUFBTSxDQUFDQztZQUNwQmpCLCtEQUFlLENBQUNpQixJQUFJO2dCQUFFRSxPQUFPO1lBQUs7WUFDbENDLFFBQVFDLEdBQUcsQ0FBQztRQUNkO1FBRUEsSUFBSSxDQUFDWixNQUFNLENBQUNPLEVBQUUsQ0FBQyxTQUFTO1lBQ3RCSSxRQUFRQyxHQUFHLENBQUM7WUFDWixJQUFJLENBQUNqQixPQUFPLEdBQUc7UUFDakI7UUFFQSxJQUFJLENBQUNLLE1BQU0sQ0FBQ08sRUFBRSxDQUFDLGdCQUFnQixPQUFPTTtZQUNwQ0YsUUFBUUMsR0FBRyxDQUFDLG9DQUFvQ0M7WUFDaEQsSUFBSSxDQUFDbEIsT0FBTyxHQUFHO1lBQ2YsTUFBTSxJQUFJLENBQUNtQixZQUFZO1lBQ3ZCLElBQUksQ0FBQ0MsVUFBVSxJQUFJLHNDQUFzQztRQUMzRDtRQUVBLElBQUksQ0FBQ0EsVUFBVTtJQUNqQjtJQUVBLE9BQWNDLGNBQThCO1FBQzFDLElBQUksQ0FBQ3RCLGVBQWV1QixRQUFRLEVBQUU7WUFDNUJ2QixlQUFldUIsUUFBUSxHQUFHLElBQUl2QjtRQUNoQztRQUNBLE9BQU9BLGVBQWV1QixRQUFRO0lBQ2hDO0lBRUEsTUFBY0YsYUFBYTtRQUN6QixJQUFJO1lBQ0YsTUFBTSxJQUFJLENBQUNmLE1BQU0sQ0FBQ2UsVUFBVTtRQUM5QixFQUFFLE9BQU9HLE9BQU87WUFDZFAsUUFBUU8sS0FBSyxDQUFDLHlDQUF5Q0E7WUFDdkQsTUFBTSxJQUFJLENBQUNKLFlBQVk7WUFDdkIsbURBQW1EO1lBQ25ESyxXQUFXLElBQU0sSUFBSSxDQUFDSixVQUFVLElBQUk7UUFDdEM7SUFDRjtJQUVBLE1BQWNELGVBQWU7UUFDM0IsSUFBSTtZQUNGLE1BQU1yQixzREFBUyxDQUFDLElBQUksQ0FBQ0csV0FBVztZQUNoQ2UsUUFBUUMsR0FBRyxDQUFDO1FBQ2QsRUFBRSxPQUFPTSxPQUFPO1lBQ2RQLFFBQVFPLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzVDO0lBQ0Y7SUFFQSxNQUFhRyxZQUFZQyxFQUFVLEVBQUVDLE9BQThCLEVBQUVDLE9BQWEsRUFBRTtRQUNsRixJQUFJLENBQUMsSUFBSSxDQUFDN0IsT0FBTyxFQUFFO1lBQ2pCLE1BQU0sSUFBSThCLE1BQU07UUFDbEI7UUFDQSxPQUFPLE1BQU0sSUFBSSxDQUFDekIsTUFBTSxDQUFDcUIsV0FBVyxDQUFDQyxJQUFJQyxTQUFTQztJQUNwRDtJQUVBLE1BQWFFLGVBQThCO1FBQ3pDLElBQUksSUFBSSxDQUFDL0IsT0FBTyxFQUFFO1FBQ2xCLE9BQU8sSUFBSWdDLFFBQVEsQ0FBQ0M7WUFDbEIsTUFBTUMsYUFBYUMsWUFBWTtnQkFDN0IsSUFBSSxJQUFJLENBQUNuQyxPQUFPLEVBQUU7b0JBQ2hCb0MsY0FBY0Y7b0JBQ2REO2dCQUNGO1lBQ0YsR0FBRztRQUNMO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlbEMsZUFBZXNCLFdBQVcsRUFBRSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaW50ZWxpZ2VuY2lhYXJ0aWZpY2lhbGdydXBvbGV0aGFuLy4vdXRpbHMvd2hhdHNhcHBDbGllbnQudHM/OGYzNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDbGllbnQsIExvY2FsQXV0aCwgTWVzc2FnZU1lZGlhIH0gZnJvbSAnd2hhdHNhcHAtd2ViLmpzJztcclxuaW1wb3J0IHFyY29kZSBmcm9tICdxcmNvZGUtdGVybWluYWwnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJztcclxuXHJcbmNsYXNzIFdoYXRzQXBwQ2xpZW50IHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogV2hhdHNBcHBDbGllbnQ7XHJcbiAgcHJpdmF0ZSBjbGllbnQ6IENsaWVudDtcclxuICBwcml2YXRlIGlzUmVhZHk6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwcml2YXRlIHNlc3Npb25QYXRoOiBzdHJpbmc7XHJcblxyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnNlc3Npb25QYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcud3dlYmpzX2F1dGgnKTtcclxuICAgIFxyXG4gICAgdGhpcy5jbGllbnQgPSBuZXcgQ2xpZW50KHtcclxuICAgICAgYXV0aFN0cmF0ZWd5OiBuZXcgTG9jYWxBdXRoKHsgXHJcbiAgICAgICAgZGF0YVBhdGg6IHRoaXMuc2Vzc2lvblBhdGgsXHJcbiAgICAgICAgY2xpZW50SWQ6ICdjbGllbnQtb25lJyAvLyBBZGljaW9uZSB1bSBJRCDDum5pY28gcGFyYSBvIGNsaWVudGVcclxuICAgICAgfSksXHJcbiAgICAgIHB1cHBldGVlcjoge1xyXG4gICAgICAgIGhlYWRsZXNzOiB0cnVlLFxyXG4gICAgICAgIGFyZ3M6IFsnLS1uby1zYW5kYm94JywgJy0tZGlzYWJsZS1zZXR1aWQtc2FuZGJveCddXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuY2xpZW50Lm9uKCdxcicsIChxcikgPT4ge1xyXG4gICAgICBxcmNvZGUuZ2VuZXJhdGUocXIsIHsgc21hbGw6IHRydWUgfSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdRUiBSRUNFSVZFRC4gU2NhbiBpdCB3aXRoIHlvdXIgV2hhdHNBcHAgYXBwLicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5jbGllbnQub24oJ3JlYWR5JywgKCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZygnV2hhdHNBcHAgY2xpZW50IGlzIHJlYWR5IScpO1xyXG4gICAgICB0aGlzLmlzUmVhZHkgPSB0cnVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5jbGllbnQub24oJ2Rpc2Nvbm5lY3RlZCcsIGFzeW5jIChyZWFzb24pID0+IHtcclxuICAgICAgY29uc29sZS5sb2coJ1doYXRzQXBwIGNsaWVudCB3YXMgZGlzY29ubmVjdGVkJywgcmVhc29uKTtcclxuICAgICAgdGhpcy5pc1JlYWR5ID0gZmFsc2U7XHJcbiAgICAgIGF3YWl0IHRoaXMuY2xlYW5TZXNzaW9uKCk7XHJcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZSgpOyAvLyBUZW50YSByZWluaWNpYWxpemFyIGFww7NzIGRlc2NvbmV4w6NvXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmluaXRpYWxpemUoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogV2hhdHNBcHBDbGllbnQge1xyXG4gICAgaWYgKCFXaGF0c0FwcENsaWVudC5pbnN0YW5jZSkge1xyXG4gICAgICBXaGF0c0FwcENsaWVudC5pbnN0YW5jZSA9IG5ldyBXaGF0c0FwcENsaWVudCgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFdoYXRzQXBwQ2xpZW50Lmluc3RhbmNlO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgV2hhdHNBcHAgY2xpZW50OicsIGVycm9yKTtcclxuICAgICAgYXdhaXQgdGhpcy5jbGVhblNlc3Npb24oKTtcclxuICAgICAgLy8gVGVudGEgaW5pY2lhbGl6YXIgbm92YW1lbnRlIGFww7NzIGxpbXBhciBhIHNlc3PDo29cclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmluaXRpYWxpemUoKSwgNTAwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGNsZWFuU2Vzc2lvbigpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGZzLnJlbW92ZSh0aGlzLnNlc3Npb25QYXRoKTtcclxuICAgICAgY29uc29sZS5sb2coJ1Nlc3Npb24gY2xlYW5lZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjbGVhbiBzZXNzaW9uOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBhc3luYyBzZW5kTWVzc2FnZSh0bzogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcgfCBNZXNzYWdlTWVkaWEsIG9wdGlvbnM/OiBhbnkpIHtcclxuICAgIGlmICghdGhpcy5pc1JlYWR5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignV2hhdHNBcHAgY2xpZW50IGlzIG5vdCByZWFkeScpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuY2xpZW50LnNlbmRNZXNzYWdlKHRvLCBjb250ZW50LCBvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBhc3luYyB3YWl0Rm9yUmVhZHkoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAodGhpcy5pc1JlYWR5KSByZXR1cm47XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgY29uc3QgY2hlY2tSZWFkeSA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5pc1JlYWR5KSB7XHJcbiAgICAgICAgICBjbGVhckludGVydmFsKGNoZWNrUmVhZHkpO1xyXG4gICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMTAwMCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFdoYXRzQXBwQ2xpZW50LmdldEluc3RhbmNlKCk7XHJcbiJdLCJuYW1lcyI6WyJDbGllbnQiLCJMb2NhbEF1dGgiLCJxcmNvZGUiLCJwYXRoIiwiZnMiLCJXaGF0c0FwcENsaWVudCIsImlzUmVhZHkiLCJzZXNzaW9uUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiY2xpZW50IiwiYXV0aFN0cmF0ZWd5IiwiZGF0YVBhdGgiLCJjbGllbnRJZCIsInB1cHBldGVlciIsImhlYWRsZXNzIiwiYXJncyIsIm9uIiwicXIiLCJnZW5lcmF0ZSIsInNtYWxsIiwiY29uc29sZSIsImxvZyIsInJlYXNvbiIsImNsZWFuU2Vzc2lvbiIsImluaXRpYWxpemUiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiZXJyb3IiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwic2VuZE1lc3NhZ2UiLCJ0byIsImNvbnRlbnQiLCJvcHRpb25zIiwiRXJyb3IiLCJ3YWl0Rm9yUmVhZHkiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNoZWNrUmVhZHkiLCJzZXRJbnRlcnZhbCIsImNsZWFySW50ZXJ2YWwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/whatsappClient.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fenviar-mensagem&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cenviar-mensagem.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();