(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[630],{7029:function(e,n,t){Promise.resolve().then(t.bind(t,7338))},7338:function(e,n,t){"use strict";var a=t(7437),l=t(2265),s=t(6284),o=t.n(s),r=t(6648);n.default=()=>{let[e,n]=(0,l.useState)([]),[t,s]=(0,l.useState)(""),[i,c]=(0,l.useState)([]),[m,u]=(0,l.useState)(""),[d,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)([]),[f,j]=(0,l.useState)(null),x=(0,l.useRef)(null),[_,C]=(0,l.useState)(!1);(0,l.useEffect)(()=>{fetch("/api/clientes").then(e=>e.json()).then(e=>n(Array.isArray(e)?e:[])).catch(e=>console.error("Erro ao buscar clientes:",e))},[]);let v=async n=>{n.preventDefault();let a=d?e:i;if(0===a.length){alert("Por favor, selecione pelo menos um cliente.");return}if(!t.trim()){alert("Por favor, digite uma mensagem.");return}let l=new FormData;l.append("mensagem",t),l.append("clientesSelecionados",JSON.stringify(a)),f&&l.append("imagem",f),console.log("Dados sendo enviados:"),console.log("Mensagem:",t),console.log("Clientes selecionados:",a),console.log("Imagem selecionada:",f?f.name:"Nenhuma");try{let e=await fetch("/api/enviar-mensagem",{method:"POST",body:l});if(e.ok){let n=await e.json();g(a),alert(n.message||"Mensagens enviadas com sucesso!")}else{let n=await e.json();console.error("Resposta do servidor:",n),alert("Erro ao enviar mensagens: ".concat(n.error))}}catch(e){console.error("Erro ao enviar mensagem:",e),alert("Erro ao enviar mensagens. Verifique o console para mais detalhes.")}},b=Array.isArray(e)?e.filter(e=>e.nome.toLowerCase().includes(m.toLowerCase())):[],E=async()=>{C(!0);try{let e=await fetch("/api/updateClients",{method:"POST"});if(e.ok){let n=await e.json();alert(n.message),N()}else throw Error("Falha ao atualizar clientes")}catch(e){console.error("Erro ao atualizar clientes:",e),alert("Erro ao atualizar clientes. Por favor, tente novamente.")}finally{C(!1)}},N=()=>{fetch("/api/clientes").then(e=>e.json()).then(e=>n(Array.isArray(e)?e:[])).catch(e=>console.error("Erro ao buscar clientes:",e))};return(0,a.jsxs)("div",{className:o().container,children:[(0,a.jsxs)("div",{className:o().leftPanel,children:[(0,a.jsx)("div",{className:o().logo,children:(0,a.jsx)(r.default,{src:"/path/to/logo.png",alt:"Logo",width:150,height:150,style:{width:"auto",height:"auto"}})}),(0,a.jsx)("h1",{children:"Enviar Mensagens"}),(0,a.jsxs)("form",{onSubmit:v,className:o().formGroup,children:[(0,a.jsxs)("label",{htmlFor:"messageTemplate",children:["Mensagem (use ","{link}"," para substituir pelo link do cliente):"]}),(0,a.jsx)("textarea",{id:"messageTemplate",value:t,onChange:e=>s(e.target.value),required:!0}),(0,a.jsx)("label",{htmlFor:"select-option",children:"Enviar para:"}),(0,a.jsxs)("select",{id:"select-option",value:d?"all":"some",onChange:e=>h("all"===e.target.value),required:!0,children:[(0,a.jsx)("option",{value:"all",children:"Todos os Clientes"}),(0,a.jsx)("option",{value:"some",children:"Selecionar Alguns Clientes"})]}),!d&&(0,a.jsxs)("div",{id:"client-select",children:[(0,a.jsx)("label",{htmlFor:"client-list",children:"Selecione os Clientes:"}),(0,a.jsx)("select",{id:"client-list",multiple:!0,size:10,value:i.map(e=>e.numero),onChange:n=>{let t=Array.from(n.target.selectedOptions).map(e=>e.value);c(e.filter(e=>t.includes(e.numero)))},className:o().multiSelect,children:b.map(e=>(0,a.jsxs)("option",{value:e.numero,children:[e.nome," (",e.numero,")"]},e.numero))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"image-upload",children:"Selecionar imagem (opcional):"}),(0,a.jsx)("input",{type:"file",id:"image-upload",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&j(e.target.files[0])},ref:x,className:o().fileInput})]}),f&&(0,a.jsxs)("p",{children:["Imagem selecionada: ",f.name]}),(0,a.jsx)("button",{type:"submit",className:o().submitButton,children:"Enviar Mensagens"})]}),(0,a.jsx)("button",{onClick:E,disabled:_,className:o().updateButton,children:_?"Atualizando...":"Atualizar Lista de Clientes"})]}),(0,a.jsxs)("div",{className:o().rightPanel,children:[(0,a.jsx)("h2",{children:"Todos os N\xfameros Cadastrados"}),(0,a.jsxs)("table",{className:o().table,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Nome"}),(0,a.jsx)("th",{children:"Telefone"}),(0,a.jsx)("th",{children:"Link"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.nome}),(0,a.jsx)("td",{children:e.numero}),(0,a.jsx)("td",{children:(0,a.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:e.link})})]},e.numero))})]})]}),(0,a.jsxs)("div",{className:o().sentPanel,children:[(0,a.jsx)("h2",{children:"Mensagens Enviadas"}),(0,a.jsx)("ul",{children:p.map(e=>(0,a.jsxs)("li",{children:["Enviado para: ",e.nome," (",e.numero,")"]},e.numero))})]})]})}},6284:function(e){e.exports={container:"ClientComponent_container__WZ04a",leftPanel:"ClientComponent_leftPanel__qXT1t",rightPanel:"ClientComponent_rightPanel__aB5JE",sentPanel:"ClientComponent_sentPanel__ouCw4",formGroup:"ClientComponent_formGroup__uOvz0",table:"ClientComponent_table__iEsLD",logo:"ClientComponent_logo__Z3NG8",updateButton:"ClientComponent_updateButton__9dMo5",submitButton:"ClientComponent_submitButton__TAfJ3",fileInput:"ClientComponent_fileInput__H9E8y",multiSelect:"ClientComponent_multiSelect__NsxZw"}}},function(e){e.O(0,[171,648,971,23,744],function(){return e(e.s=7029)}),_N_E=e.O()}]);